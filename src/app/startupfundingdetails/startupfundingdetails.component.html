<form #formRef="ngForm">
  <h3 class="bg-blue-600 text-white p-4 mb-4 rounded">Startup Funding Details</h3>

  <label class="mb-4 text-lg font-medium flex items-center gap-2">
    <input type="checkbox" [(ngModel)]="isFundingDetailsEnabled" name="isFundingDetailsEnabled" />
    Funding Details
  </label>

  <div class="overflow-x-auto">
    <table class="min-w-full bg-white border border-gray-300">
      <thead>
        <tr class="bg-gray-200 font-medium text-center">
          <th class="border border-gray-300 px-2 py-1">SN</th>
          <th class="border border-gray-300 px-2 py-1">Scheme Name*</th>
          <th class="border border-gray-300 px-2 py-1">Institution Name*</th>
          <th class="border border-gray-300 px-2 py-1">Institution Type*</th>
          <th class="border border-gray-300 px-2 py-1">Format of Funding*</th>
          <th class="border border-gray-300 px-2 py-1">Sanction Amount*</th>
          <th class="border border-gray-300 px-2 py-1">Disbursement Amount*</th>
          <th class="border border-gray-300 px-2 py-1">Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let element of fundingRows; let i = index" class="text-center">
          <td class="border border-gray-300 px-2 py-1">{{ i + 1 }}</td>
          <td class="border border-gray-300 px-2 py-1">
            <input
              type="text"
              [(ngModel)]="fundingRows[i].schemeName"
              name="schemeName{{i}}"
              placeholder="Scheme Name"
              [disabled]="element.edit"
              required
              #schemeName="ngModel"
              class="w-full border border-gray-300 rounded px-2 py-1"
            />
            <div *ngIf="schemeName.invalid && schemeName.touched" class="text-red-600 text-sm">This field is required.</div>
          </td>
          <td class="border border-gray-300 px-2 py-1">
            <input
              type="text"
              [(ngModel)]="fundingRows[i].institutionName"
              name="institutionName{{i}}"
              placeholder="Institution Name"
              [disabled]="element.edit"
              required
              #institutionName="ngModel"
              class="w-full border border-gray-300 rounded px-2 py-1"
            />
            <div *ngIf="institutionName.invalid && institutionName.touched" class="text-red-600 text-sm">This field is required.</div>
          </td>
          <td class="border border-gray-300 px-2 py-1">
            <select
              [(ngModel)]="fundingRows[i].institutionType"
              name="institutionType{{i}}"
              [disabled]="element.edit"
              required
              #institutionType="ngModel"
              class="w-full border border-gray-300 rounded px-2 py-1"
            >
              <option value="" disabled selected>Select Type</option>
              <option *ngFor="let type of incubatorTypes" [value]="type">{{ type }}</option>
            </select>
            <div *ngIf="institutionType.invalid && institutionType.touched" class="text-red-600 text-sm">This field is required.</div>
          </td>
          <td class="border border-gray-300 px-2 py-1">
            <select
              [(ngModel)]="fundingRows[i].formatOfFunding"
              name="formatOfFunding{{i}}"
              [disabled]="element.edit"
              required
              #formatOfFunding="ngModel"
              class="w-full border border-gray-300 rounded px-2 py-1"
            >
              <option value="" disabled selected>Select</option>
              <option *ngFor="let format of fundingFormats" [value]="format">{{ format }}</option>
            </select>
            <div *ngIf="formatOfFunding.invalid && formatOfFunding.touched" class="text-red-600 text-sm">This field is required.</div>
          </td>
          <td class="border border-gray-300 px-2 py-1">
            <input
              type="number"
              [(ngModel)]="fundingRows[i].sanctionAmount"
              name="sanctionAmount{{i}}"
              placeholder="Sanction Amount"
              [disabled]="element.edit"
              required
              #sanctionAmount="ngModel"
              class="w-full border border-gray-300 rounded px-2 py-1"
            />
            <div *ngIf="sanctionAmount.invalid && sanctionAmount.touched" class="text-red-600 text-sm">This field is required.</div>
          </td>
          <td class="border border-gray-300 px-2 py-1">
            <input
              type="number"
              [(ngModel)]="fundingRows[i].disbursementAmount"
              name="disbursementAmount{{i}}"
              placeholder="Disbursement Amount"
              [disabled]="element.edit"
              required
              #disbursementAmount="ngModel"
              class="w-full border border-gray-300 rounded px-2 py-1"
            />
            <div *ngIf="disbursementAmount.invalid && disbursementAmount.touched" class="text-red-600 text-sm">This field is required.</div>
          </td>
          <td class="border border-gray-300 px-2 py-1">
            <button *ngIf="element.edit" type="button" class="text-blue-600 underline" (click)="editRow(i)">Edit</button>
            <button *ngIf="!element.edit" type="button" class="text-blue-600 underline" [disabled]="formRef.invalid" (click)="saveRow(i)">Save</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="flex justify-end gap-4 mt-4">
    <button type="button" class="bg-blue-600 text-white px-4 py-2 rounded" (click)="addRow()">Add New Row</button>
  </div>

  <div class="flex justify-end gap-4 mt-6">
    <button type="button" class="bg-blue-600 text-white px-4 py-2 rounded" (click)="back()">Back</button>
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded" [disabled]="formRef.invalid" (click)="onSave()">Save & Next</button>
  </div>
</form>
